type GlobalStats @entity {
  id: Bytes!
  totalExecutedBundlesCount: BigInt!
  totalValidatorsPaid: BigInt!
  totalValidatorsCount: BigInt!
  totalUniqueSearchers: BigInt!
  # totalOpportunitiesCount: BigInt!
  
  hourlyCollectionSnapshotGlobal: [HourlyCollectionSnapshotGlobal!]! @derivedFrom(field: "target")
  dailyCollectionSnapshotGlobal: [DailyCollectionSnapshotGlobal!]! @derivedFrom(field: "target")
  weeklyCollectionSnapshotGlobal: [WeeklyCollectionSnapshotGlobal!]! @derivedFrom(field: "target")
}

type HourlyCollectionSnapshotGlobal @entity {
  "The hour"
  id: Bytes!
  target: GlobalStats!
  timestamp: Int
  hourlyVolume: BigDecimal!
  validators: [Validator!]!
  hourlyTransactions: Int
  hourlyAvgBid: BigDecimal!
  topBid: BigDecimal!
}

type DailyCollectionSnapshotGlobal @entity {
  "The day"
  id: Bytes!
  target: GlobalStats!
  timestamp: Int
  dailyVolume: BigDecimal!
  validators: [Validator!]!
  dailyTransactions: Int
  dailyAvgBid: BigDecimal!
  topBid: BigDecimal!
}

type WeeklyCollectionSnapshotGlobal @entity {
  "The week"
  id: Bytes!
  target: GlobalStats!
  timestamp: Int
  weeklyVolume: BigDecimal!
  validators: [Validator!]!
  weeklyTransactions: Int
  weeklyAvgBid: BigDecimal!
  topBid: BigDecimal!
}

type HourlyValidatorSnapshot @entity {
  "The hour"
  id: Bytes!
  target: Validator!
  timestamp: Int
  hourlyVolume: BigDecimal!

  hourlyTransactions: Int
  hourlyAvgBid: BigDecimal!
  topBid: BigDecimal!
}

type DailyValidatorSnapshot @entity {
  "The day"
  id: Bytes!
  target: Validator!
  timestamp: Int
  dailyVolume: BigDecimal!

  dailyTransactions: Int
  dailyAvgBid: BigDecimal!
  topBid: BigDecimal!
}
type WeeklyValidatorSnapshot @entity {
  "The week"
  id: Bytes!
  target: Validator!
  timestamp: Int
  weeklyVolume: BigDecimal!

  weeklyTransactions: Int
  weeklyAvgBid: BigDecimal!
  topBid: BigDecimal!
}

type Searcher @entity {
  id: Bytes!
  address: Bytes!
  bundlesLanded: Int!
  totalTipped: BigInt!
  lastBundleLandedTimestamp: Int!
  bundles: [RelayFlashBid!]! @derivedFrom(field: "sender")
}

enum ValidatorStatus {
  INACTIVE
  ACTIVE
}

type Validator @entity {
  id: Bytes!
  address: Bytes!
  status: ValidatorStatus!
  enabledAt: Int!
  disabledAt: Int!
  totalTips: BigInt!
  lastBundleReceivedTimestamp: Int!
  hourlyValidatorSnapshot: [HourlyValidatorSnapshot!]! @derivedFrom(field: "target")
  dailyValidatorSnapshot: [DailyValidatorSnapshot!]! @derivedFrom(field: "target")
  weeklyValidatorSnapshot: [WeeklyValidatorSnapshot!]! @derivedFrom(field: "target")
  bundles: [RelayFlashBid!]! @derivedFrom(field: "validator")
}

type RelayFlashBid @entity(immutable: true) {
  id: Bytes!
  sender: Searcher! # address
  amount: BigInt! # uint256
  oppTxHash: Bytes! # bytes32
  validator: Validator!
  searcherContractAddress: Bytes! # address
  blockNumber: BigInt!
  blockTimestamp: BigInt!
  transactionHash: Bytes!
}



